(function(c){var k={init:function(b){return this.each(function(){function k(){if(j){console.log("aca dentro",j);for(ajaxRequest in j)j[ajaxRequest].abort();j=null}}function r(){q&&clearTimeout(q);q=setTimeout(v,a.keyDelay)}function v(){var d=c.trim(e.val()).replace(/[\\]+|[\/]+/g,"").replace(/\s+/g," ");n=d;if(d.length>=a.minChars){a.beforeRetrieve&&(d=a.beforeRetrieve.call(this,d));e.addClass("loading");a.loadingText&&i.html('<li class="ds-message">'+a.loadingText+"</li>").show();f.show();if(a.remoteSource)for(url in k(),
"string"===typeof a.remoteSource&&(a.remoteSource=[a.remoteSource]),j=[],a.remoteSource){var g={};g[a.queryParam]=d;j[url]=c.getJSON(a.remoteSource[url],c.extend({},g,a.extraParams),function(a){s(a,d,false)})}a.localSource&&s(a.localSource,d,!0)}else f.hide()}function t(d){if(0<c("li.ds-result-item:visible",f).length){var g=c("li",f),b="down"===d?g.eq(0):g.filter(":last"),i=c("li.active:first",f);0<i.length&&(b="down"===d?i.next():i.prev());g.removeClass("active");b.addClass("active");0<b.length&&
a.onResultFocus.call(e,b.data());d=0<b.length?b.data()[a.selectValue]:n;e.val(d)}}function s(d,g,b){var d=a.retrieveComplete.call(this,d,g,b),j=a.seekValue.split(","),k=0,l=0;if(b||!a.localSource)i.html(""),f.hide();for(var n in d)if(d.hasOwnProperty(n)){for(var m="",h=0;h<j.length;h++)m+=void 0!==d[l][c.trim(j[h])]?d[l][c.trim(j[h])]:"";a.matchCase||(m=m.toLowerCase(),g=g.toLowerCase());var h=g.split(" "),o=!1,p;for(p in h)h.hasOwnProperty(p)&&-1!==m.search(h[p])&&(o=!0);if(!0===o){d[l]._dataSource=
b?"local":"remote";d[l]._number=k;m=c('<li class="ds-result-item" id="ds-result-item-'+l+'"></li>').data(d[l]);o=c.extend({},d[l]);if(a.resultsHighlight)for(p in h)h.hasOwnProperty(p)&&(o[a.selectValue]=o[a.selectValue].replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+h[p]+")(?![^<>]*>)(?![^&;]+;)",""+(!a.matchCase?"gi":"g")+""),"<em>$1</em>"));h=a.formatList?a.formatList.call(e,o,m):m.html(o[a.selectValue]);i.append(h);k++;if(a.queryLimit&&a.queryLimit===k)break}l++}e.removeClass("loading");0>=k&&a.emptyText&&
i.html('<li class="ds-message">'+a.emptyText+"</li>");f.show();a.resultsComplete.call(this)}var a=c.extend({},c.fn.doubleSuggest.defaultOptions,b),e=c(this).addClass("ds-input"),u=e.attr("id"),w=c('<div class="ds-container" id="ds-container-'+u+'"></div>');e.wrap(w);var f=c('<div class="ds-results" id="ds-results-'+u+'"></div>').hide();e.after(f);var i=c('<ul class="ds-list"></ul>').css("width",e.outerWidth()).appendTo(f),n="",q=null,j=null;e.on({"focus.doubleSuggest":function(){""!==c.trim(e.val())&&
f.show()},"keydown.doubleSuggest":function(d){var b=d.keyCode;switch(b){case 38:case 40:d.preventDefault();38===b?t("up"):t("down");break;case 8:1===e.val().length&&f.hide();r();break;case 9:case 13:b=c.trim(e.val());""!==b&&b.length>=a.minChars&&0<c("li.ds-result-item:visible",f).length&&0<c("li.active:first",i).length&&(c("li.active:first",i).trigger("select"),d.preventDefault());break;case 27:k();f.hide();break;default:46===b||9<b&&32>b?f.hide():r()}},"blur.doubleSuggest":function(){f.is(":hover")||
(e.val(n),f.hide())},"updateOptions.doubleSuggest":function(d,e){a=c.extend(c.fn.doubleSuggest.defaultOptions,b,e)},"destroy.doubleSuggest":function(){f.remove();e.val("").removeClass("ds-input").unbind(".doubleSuggest").unwrap()}});f.on({click:function(){c(this).trigger("select")},mouseover:function(){c("li",i).removeClass("active");c(this).addClass("active");a.onResultFocus.call(e,c(this).data())},select:function(){var b=c(this),g=b.data();n=g[a.selectValue];e.val(n);a.onSelect.call(e,g,b);i.html("");
f.hide()}},".ds-result-item")})},update:function(b){return this.each(function(){c(this).trigger("updateOptions",b)})},destroy:function(){return this.each(function(){c(this).trigger("destroy")})}};c.fn.doubleSuggest=function(b){if(k[b])return k[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof b||!b)return k.init.apply(this,arguments);c.error("Invalid arguments "+b+" on jQuery.doubleSuggest")};c.fn.doubleSuggest.defaultOptions={localSource:!1,remoteSource:!1,emptyText:!1,
loadingText:"Loading...",newItem:!1,selectValue:"name",seekValue:"name",queryParam:"q",queryLimit:!1,extraParams:{},matchCase:!1,minChars:1,keyDelay:500,resultsHighlight:!0,onSelect:function(){},onResultFocus:function(){},formatList:!1,beforeRetrieve:function(b){return b},retrieveComplete:function(b){return b},resultsComplete:function(){}}})(jQuery);