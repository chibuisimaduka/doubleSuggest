<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>doubleSuggest jQuery plug-in</title>
    <link type="text/css" rel="stylesheet" href="css/shCoreRDark.css"/>
    <link rel="stylesheet" href="css/styles.css" type="text/css"></link>
    <link rel="stylesheet" href="css/doubleSuggest.css" type="text/css"></link>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.doubleSuggest.min.js"></script>
    <script type="text/javascript" src="js/shCore.js"></script>
    <script type="text/javascript" src="js/shBrushJScript.js"></script>
    <script type="text/javascript" src="js/shBrushXml.js"></script>
    <script type="text/javascript">
        SyntaxHighlighter.defaults['gutter'] = false;
        SyntaxHighlighter.all();
    </script>
  </head>
  <body>
    <h1>doubleSuggest</h1>
    <nav>
      <ul>
        <li><a class="current-page" href="index.html">HOME</a></li>
        <li>&#8226;</li>
        <li><a href="options.html">OPTIONS</a></li>
        <li>&#8226;</li>
        <li><a title="Live demo [opens in a new tab]" target="_blank" href="http://jsbin.com/adejub/7/">TRY IT!</a></li>
      </ul>
      <div class="clear-fix"></div>
    </nav>
    <hr>
    <p class="desc">
      This jQuery plugin will set up a UI that suggest results as you type. <br>
      It will display two types of suggestions, first (and faster) the local data 
      and second (and slower) the results from an ajax search query. 
      <br>
    </p>
    <hr>

    <br>
    <form action="#" style="width: 520px; margin: 0px auto;">
    <p>Type <b>"m"</b> to get band suggestions from <a href="http://spotify.com">Spotify</a> and a locally cached list.</p>
      <input type="text" style="width: 500px;" id="search" placeholder="This is the input's native placerholder attribute" autocomplete="off"/>
    </form>
    <br>

    <h2>Quick setup tour</h2>
    <p>We will build a band search feature that will suggest the user's favorites first and also search remotly from spotify. <br/> 
    Include the jQuery library <b>(requires v1.7 or higher)</b>, jquery.doubleSuggest.js and doubleSuggest.css and then insert the input. 
    <br><b>Note the placeholder and autocomplete attributes.</b>
    </p>
      <!-- // <script src="https://gist.github.com/1919467.js?file=gistfile1.js"></script> -->
    <pre class="brush: html;">
        <input type="text" id="search" placeholder="Search" autocomplete="off" />
    </pre>
    
    <p>As localSource, some "favorite bands" will be served quickly. This feature can be used for caching searchable content that the user may want to access faster, like Facebook does when suggesting friends as you search for example.</p>
    <pre class="brush: js;">
        var favoriteBands = [
            { "band_id":"1", "name":"Metallica", "cover":"http://..." },
            { "band_id":"2", "name":"Megadeth", "cover":"http://..." },
            { "band_id":"3", "name":"Slayer", "cover":"http://..." },
            { "band_id":"4", "name":"Blackguard", "cover":"http://..." },
            { "band_id":"5", "name":"Limp Bizkit", "cover":"http://..." },
            { "band_id":"6", "name":"Iron Maiden", "cover":"http://..." },
            { "band_id":"7", "name":"Our Last Night", "cover":"http://..." }
        ];
    </pre>

    <p>Bind the plugin to an input and tell it which part of the source to search. For this you have the <b>seekValue</b> option that accepts a comma separated list of attributes to search on (like "title, artist, albums").<br>
    <b>selectValue</b> is the property that will fill the input when you hover or select a result. As both are "name" by default the are not really needed. 
    <br>
    We send the user query in the <b>queryParam</b> to Spotify as you can see in the <b>remoteSource</b> option. Spotify uses "q" which is the default.
    </p>
    <pre class="brush: js;">
        $('#search').doubleSuggest({
            localSource: favoriteBands,
            remoteSource: "http://ws.spotify.com/search/1/artist.json",
            selectValue: "name", 
            seekValue: "name", // Can be "title, albums, genre"
            queryParam: "q" // By default is "q", so not needed
        });
    </pre>

    <p>As Spotify does not have a param to limit the number of results returned, we will use the <b>retrieveComplete</b> callback to slice just 6 results and return that as the data be processed.<br>
    Also we got some album covers for the fav bands, so <b>formatList</b> function will allow us to insert those images in the results list.</p>
    <pre class="brush: js;">
        $(function(){
            $('#search').doubleSuggest({
                localSource: favoriteBands,
                remoteSource: "http://ws.spotify.com/search/1/artist.json",
                retrieveComplete: function (data, queryParam, isLocal) {
                    if(!isLocal) return data.artists.slice(0,6);
                    else return data;
                },
                formatList: function(data, $elem) {
                    if (data['_dataSource'] == 'local') {
                        var html = "<div>
                                    <img src="+data['cover']+" /> 
                                    <span>"+data['name']+"</span>
                                    </div>";
                    } else {
                        var html = "<div>" + data['name'] + "</div>";
                    }
                    return $elem.html(html);
                },
                onSelect: function(data, $elem) {
                    console.log(data);
                }
            });
        });
    </pre>
      <script type="text/javascript">
        $(function(){

            var favoriteBands = [
                {
                    "band_id":"84",
                    "name":"Metallica",
                    "cover":"img/small_9f57602a3df411e1be054040ccbc51ae.jpg"
                },
                {
                    "band_id":"85",
                    "name":"Megadeth",
                    "cover":"img/small_13247671274ef657975d210.jpg"
                },
                {
                    "band_id":"92",
                    "name":"Slayer",
                    "cover":"img/small_12695399454ec835a905368.jpg"
                },
                {
                    "band_id":"11",
                    "name":"Blackguard",
                    "cover":"img/small_1e2c0480430b11e1be364040a407f32f.jpg"
                },
                {
                    "band_id":"65",
                    "name":"Limp Bizkit",
                    "cover":"img/small_cafa93da5cd211e1971840405732574f.jpg"
                },
                {
                    "band_id":"6",
                    "name":"Our Last Night",
                    "cover":"img/small_81e81b205bee11e19eb440405732574f.jpg"
                },
                {
                    "band_id":"920",
                    "name":"Iron Maiden",
                    "cover":"img/small_13244306044ef1350c02b3d.jpg"
                }
            ];

            $('#search').doubleSuggest({
                localSource: favoriteBands,
                remoteSource: "http://ws.spotify.com/search/1/artist.json",
                selectValue: "name", 
                seekValue: "name, tags",
                queryParam: "q",
                retrieveComplete: function (data, queryParam, isLocal) {
                    if(!isLocal) return data.artists.slice(0,6);
                    else return data;
                },
                formatList: function(data, $elem) {
                    if (data['_dataSource'] == 'local') {
                        var html = "<div style='clear:both; display: table-cell; width: 100%;'><img style='float: left;' width='45' src='"+data['cover']+"' /> <span style='float: left; padding: 15px 0 0 10px;'>"+data['name']+"</span></div>";
                    } else {
                        var html = "<div style='clear:both; display: table-cell; width: 100%;'>"+data['name']+"</div>";
                    }
                    return $elem.html(html);
                    },
                onSelect: function(data, $elem) {
                    console.log(data);
                }
            });
        });
      </script>
      
      <br>
      
      <h2>Set a new value to the input</h2>
      If you want to set an initial value just use the input's value attribute and doubleSuggest will automatically pick it up for you.
      <pre class="brush: html;">
        <input type="text" id="search" autocomplete="off" value="My value" />
      </pre>

      If later in your custom js script you need to programatically set a new value to a doubleSuggest input, try <i>setValue</i>.
      <br /> 
      <b>Note: this will not fire a new search request</b>, it will just update the typed-text state variable that doubleSuggest uses internally. 

      <pre class="brush: js;">
        $('#search').doubleSuggest('setValue', 'My new value');
      </pre>

      <br>
      
      <h2>Trigger a new search request</h2>
      Triggering a new search request will to exactly the same as if the user had typed what's in the input field, and show the results list.

      <pre class="brush: js;">
        $('#search').doubleSuggest('refresh');
      </pre>

      <br>
      
      <h2>Update and destroy</h2>
      It is sometimes useful to update some settings programatically. Use the update param to modify any of the doubleSuggest's options at runtime.
      <pre class="brush: js;">
        $.getJSON('/getNewBands', function (response) {
            $('#test, #test2').doubleSuggest('update', { 
                localSource: response,
                minChars: 2 
            });
        });
      </pre>

      To unbind all doubleSuggest's methods (and remove all the UI) use the destroy param.
      <pre class="brush: js;">
        $("#searchBands, #searchSongs").doubleSuggest("destroy");
      </pre>
      
      <br>
      
      <h2>Thinking on improving it?</h2>
      <a href="https://github.com/hernantz/doubleSuggest">Fork it on GitHub!</a>. The source code fully comented. <a href="http://closure-compiler.appspot.com">Closure compiler</a> with the "simple" optimization option was used for the minified version.
      <p>
        <b>This doubleSuggest jQuery plug-in is licensed under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT license</a></b>
      </p>
      <a href="https://github.com/hernantz/doubleSuggest"><img style="position: fixed; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png" alt="Fork me on GitHub"></a>

  </body>
</html>
